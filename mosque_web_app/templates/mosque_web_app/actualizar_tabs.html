
{% extends 'base.html' %}
{% load static %}
{% block title %}About the Mosque and his cool staff {% endblock %}
{% block meta_description %} This is the web site of the greatest Mosque who ever good {% endblock %}
{% block content %}


<div class="container-fluid py-5">
    <div class="container">
        <div class="row g-5">
            <div class="col-xl-12 col-lg-12 wow slideInUp" data-wow-delay="0.3s">
                <h2>Modificar una Pestaña</h2>
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    
                    <div class="mb-3">
                        <label for="tab_nombre" class="form-label">Nombre</label>
                        {{ form.tab_nombre }}
                    </div>

                    <div class="mb-3">
                        <label for="tab_slug" class="form-label">Slug</label>
                        {{ form.tab_slug }}
                    </div>

                    <div class="mb-3">
                        <label for="tab_description" class="form-label">Descripción</label>
                        {{ form.tab_description }}
                    </div>

                    <div class="mb-3">
                        <label for="tab_url" class="form-label">URL</label>
                        {{ form.tab_url }}
                    </div>

                    <button class="btn btn-primary w-100 py-3 mt-1" type="submit">Guardar</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- <script>
    $(document).ready(function () {
        $("#id_tab_nombre").on("input", function () {
            let nombre = $(this).val();
            let slug = nombre.toLowerCase().trim().replace(/\s+/g, '-').replace(/[^\w-]/g, '');
            $("#id_tab_slug").val(slug);

            // AJAX para actualizar el slug en la base de datos
            $.ajax({
                url: "{% url 'actualizar_nombre_tab' %}",  // Asegúrate de definir esta URL en tu urls.py
                type: "POST",
                data: {
                    "tab_id": "{{ form.instance.id }}",  // Obtiene el ID del objeto en edición
                    "nuevo_slug": slug,
                    "csrfmiddlewaretoken": "{{ csrf_token }}"
                },
                success: function (data) {
                    if (data.status === "success") {
                        console.log("Slug actualizado: " + data.nuevo_slug);
                    } else {
                        console.error("Error: " + data.message);
                    }
                },
                error: function () {
                    console.error("Error al actualizar el slug.");
                }
            });
        });
    });
</script> -->

<script>
    function actualizarNombre(tab_id) {
        let nuevoNombre = document.getElementById("tab_" + tab_id).value;

        $.ajax({
            url: "{% url 'actualizar_nombre_tab' %}",
            type: "POST",
            data: {
                "tab_id": tab_id,
                "nuevo_nombre": nuevoNombre,
                "csrfmiddlewaretoken": "{{ csrf_token }}"
            },
            success: function (data) {
                if (data.status === "success") {
                    alert("Nombre actualizado: " + data.nuevo_nombre);
                } else {
                    alert("Error: " + data.message);
                }
            },
            error: function () {
                alert("Error al actualizar el nombre.");
            }
        });
    }
</script>

{% endblock %}

